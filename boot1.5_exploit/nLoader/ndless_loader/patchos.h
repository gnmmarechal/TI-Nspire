// OS ID = value at offset 0x20 - order by values
#define CX360_5XX		0x10375620
#define CXC360_546_550	0x10376090
#define CX440_532		0x103A9F50
#define CXC440_532		0x103AA4E0
#define CX450_1180		0x103B1860
#define CXC450_1180		0x103B1E60

/*
patch if !ndless no boot2upd
look for
3.1 : F0 47 2D E9 00 03 9F E5 78 D0 4D E2 FC 12 9F E5
OS 3.6-4.0.0:
10 F0 45 2D E9 FC 03 9F E5 8C D0 4D E2 F8 13 9F E5
replace F0452DE9 by 0xE12FFF1E
OS 4.0.2+:
10 F0 4F 2D E9 24 84 9F E5 9C D0 4D E2 00 30 98 E5 1C 04 9F E5 1C 14 9F E5 94 30 8D E5
replace F04F2DE9 by 0xE12FFF1E
*/

#define BOOT2UPD_CX360_5XX		0x100BDED4
#define BOOT2UPD_CXC360_546_550	0x100BE1BC
#define BOOT2UPD_CXC440_53X		0x100C8D14
#define BOOT2UPD_CX440_532		0x100C8EF4
#define BOOT2UPD_CXC450_1180	0x100C992C
#define BOOT2UPD_CX450_1180		0x100C9AF0

#define NBOOT_CX360_5XX			0x100bf91c
#define NBOOT_CXC360_546_550	0x100bfc04

/*
patch modified OS self-destruct
- look for
10 10 00 00 00 11 F0 40 2D E9 00 71 9F E5 00 21 9F E5
F0 FF 00 00 00 FF FF FF FF FF 00 FF FF FF 00 FF FF FF 
replace F0402D9 by 0xE12FFF1E
*/
#define SELFD_CX360_5XX			0x10135838
#define SELFD_CXC360_546_550	0x10135E8C
#define SELFD_CX440_532			0x10155FB4
#define SELFD_CXC440_532		0x10156164
#define SELFD_CX450_1180		0x10157DC4
#define SELFD_CXC450_1180		0x10157FE0

/* ASIC bytes :
					CX			CXCAS		CM			CMCAS
asic1:	900A0028	00000000	00010105	00010107	00000002
asic2:	900A002C	00000000	04000001	88000001	8C000000
MOV R4, #asic2:		0xE3A04000	0xE3A04341	0xE3A04362	0xE3A04323
					0040A0E3	4341A0E3	6243A0E3	2343A0E3
*/
// asic1 :	2C 00 8D E5 01 00 A0 E3 28 50 93 E5 2C 40 93 E5
// mask :  	FF 00 FF FF FF FF FF FF FF FF FF FF FF FF FF FF
// 0x34 -> 0x54 a little before that
#define ASIC1_CX360_5XX			0x100C0055
#define ASIC1_CXC360_546_550	0x100C033D
#define ASIC1_CXC440_53X		0x100CAF71
#define ASIC1_CX440_532			0x100CB151
#define ASIC1_CXC450_1180		0x100CBB89
#define ASIC1_CX450_1180		0x100CBD4D

// asic2 :	10 41 9F E5 88 D0 4D E2 2C 20 94 E5
#define ASIC2_CX440_532		0x108B3538
#define ASIC2_CX450_1180	0x108BF368
#define ASIC2_CXC440_532	0x108D0718
#define ASIC2_CXC450_1180	0x108DC6D0

#define NDLESS_LOADER \
        0xE92D4030, 0xE59F30B0, 0xE59F20B0, 0xE59F50B0,\
        0xE59F10B0, 0xE5832C00, 0xE08F5005, 0xE3A02000,\
        0xE5832008, 0xE24DD02C, 0xE5832C00, 0xE1A00005,\
        0xE08F1001, 0xE59F3090, 0xE12FFF33, 0xE2504000,\
        0x0A00001A, 0xE1A0100D, 0xE1A00005, 0xE59F307C,\
        0xE12FFF33, 0xE59D0014, 0xE59F3074, 0xE12FFF33,\
        0xE59D1014, 0xE3A02001, 0xE1A03004, 0xE59FC064,\
        0xE1A05000, 0xE12FFF3C, 0xE1A00004, 0xE59F3058,\
        0xE12FFF33, 0xE59F3054, 0xE28D1028, 0xE08F3003,\
        0xE5213004, 0xEE17FF7A, 0x1AFFFFFD, 0xE3A03000,\
        0xEE073F17, 0xE3A00001, 0xE2855004, 0xE12FFF35,\
        0xE3A00000, 0xE28DD02C, 0xE8BD8030, 0x90060000,\
        0x1ACCE551, 0x000000C4, 0x000000D7, 0xAAAAAAAA,\
        0xBBBBBBBB, 0xCCCCCCCC, 0xDDDDDDDD, 0xEEEEEEEE,\
        0x0000007E, 0x636F642F, 0x6E656D75, 0x6E2F7374,\
        0x73656C64, 0x646E2F73, 0x7373656C, 0x7365725F,\
        0x6372756F, 0x742E7365, 0x0000736E, 0x72000000,\
        0x004C0062, 0x00000000, 0x00000000, 0x00000000
		
#define OFFSET_MODEL 0x33

#define NSYSCALLS	5

#define FOPEN_CX360_5XX			0x103FC858
#define FOPEN_CXC360_546_550	0x103FD2C8
#define FOPEN_CX440_532			0x10431D50
#define FOPEN_CXC440_532		0x104322E0
#define FOPEN_CX450_1180		0X10439660
#define FOPEN_CXC450_1180		0x10439C60

#define STAT_CX360_5XX			0x10404950
#define STAT_CXC360_546_550		0x104053C0
#define STAT_CX440_532			0x10439FC8
#define STAT_CXC440_532			0x1043A558
#define STAT_CX450_1180			0x104418D8
#define STAT_CXC450_1180		0x10441ED8

#define MALLOC_CX360_5XX		0x103F6DF0
#define MALLOC_CXC360_546_550	0x103F7860
#define MALLOC_CX440_532		0x1042C414
#define MALLOC_CXC440_532		0x1042C9A4
#define MALLOC_CX450_1180		0x10433D24
#define MALLOC_CXC450_1180		0x10434324

#define FREAD_CX360_5XX			0x103FC9FC
#define FREAD_CXC360_546_550	0x103FD46C
#define FREAD_CX440_532			0x10431EF4
#define FREAD_CXC440_532		0x10432484
#define FREAD_CX450_1180		0x10439804
#define FREAD_CXC450_1180		0x10439E04

#define FCLOSE_CX360_5XX		0x103FC0CC
#define FCLOSE_CXC360_546_550	0x103FCB3C
#define FCLOSE_CX440_532		0x10431570
#define FCLOSE_CXC440_532		0x10431B00
#define FCLOSE_CX450_1180		0x10438E80
#define FCLOSE_CXC450_1180		0x10439480
